Starting ...
test1
test2
test3
test4
test5
test6
cuda
Properties to use:  ['affinity', 'logps']
max affinity: -3.8 | min affinity: -13.6
Building Vocab
{'batch_size': 128, 'd_model': 512, 'n_heads': 8, 'n_layers': 6, 'hidden_units': 512, 'lr': 1e-05, 'epochs': 10, 'properties': ['affinity', 'logps'], 'run_name': 'LCK_DOCKSTRING_FAST_ACTUAL_affinity_logps'}
length of preference data : 41795
Sample preference_data[0]: ['O1C(C(=O)N2CCN(CC2)C3=CC=C(N(=O)=O)C=C3)=C(C=4C1=CC=CC4)C', array([0.47959185, 0.53255087, 0.54797947, 0.15855041, 0.16055913]), [np.str_('O1C(=NC2=C(C1=O)C=CC=C2)C3=C(C(=O)NCCC4=CC=CC=C4)C=CC(OC)=C3'), np.float64(0.9873459430403937), array([0.52040816, 0.54211667, 0.55725834, 0.15815913, 0.16377715])], [np.str_('O1C(=NC2=C(C1=O)C=CC=C2)C3=CC(OC(=O)C=4C=CC=CC4)=C(OC)C=C3'), np.float64(0.9574398041990725), array([0.43877551, 0.55263869, 0.41284505, 0.14420153, 0.15814562])]]
LCK_DOCKSTRING_FAST_ACTUAL_affinity_logps
len(target_smiles): 41800
len(data): 41800
LCK_DOCKSTRING_FAST_ACTUAL_affinity_logps
dataset built
cuda
True
2.7.1+cu118
No of GPUs available 4

==================================================
Generating molecules with target properties...
==================================================

Generating for -10_2...
Generated 128 samples for -10_2 in 19.72 seconds.
Generating for -10_3...
Generated 128 samples for -10_3 in 18.00 seconds.
Generating for -10_5...
Generated 128 samples for -10_5 in 17.64 seconds.
Generating for -9_2...
Generated 128 samples for -9_2 in 17.53 seconds.
Generating for -9_3...
Generated 128 samples for -9_3 in 17.51 seconds.
Generating for -9_5...
Generated 128 samples for -9_5 in 17.87 seconds.
Generating for -8_2...
Generated 128 samples for -8_2 in 17.51 seconds.
Generating for -8_3...
Generated 128 samples for -8_3 in 17.49 seconds.
Generating for -8_5...
Generated 128 samples for -8_5 in 17.72 seconds.
Generating for -7_2...
Generated 128 samples for -7_2 in 17.47 seconds.
Generating for -7_3...
Generated 128 samples for -7_3 in 17.51 seconds.
Generating for -7_5...
Generated 128 samples for -7_5 in 17.51 seconds.
Generating for -6_2...
Generated 128 samples for -6_2 in 17.42 seconds.
Generating for -6_3...
Generated 128 samples for -6_3 in 17.76 seconds.
Generating for -6_5...
Generated 128 samples for -6_5 in 17.31 seconds.

==================================================
Generated molecules saved to: ../checkpoints/DPO_Finetuning_BETA_0.11_epochs_10_LCK_DOCKSTRING_FAST_ACTUAL_affinity_logps/generated_molecules.pkl
To analyze and plot results, run:
python analyze_generated_molecules.py --checkpoint_dir ../checkpoints/DPO_Finetuning_BETA_0.11_epochs_10_LCK_DOCKSTRING_FAST_ACTUAL_affinity_logps --properties affinity logps
==================================================

No of GPUs available 4
Temperature:  0.5
Sampling: iteration: 0/51{'Validity': 0.9697265625, 'Novelty': 1.0, 'Uniqueness': 0.9778449144008057}
dict_keys(['smiles_rep', 'properties', 'smiles'])
validity rate 0.9697265625
